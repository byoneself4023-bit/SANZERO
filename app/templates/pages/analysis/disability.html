{% extends "base.html" %}

{% block title %}ì¥í•´ë“±ê¸‰ ì˜ˆì¸¡ - SANZERO{% endblock %}

{% block extra_head %}
<meta name="description" content="{{ description }}">
<!-- ì¥í•´ë“±ê¸‰ ì˜ˆì¸¡ ì „ìš© ìŠ¤íƒ€ì¼ -->
<!-- ì¸ë¼ì¸ ê¸°ë³¸ ìŠ¤íƒ€ì¼ (CDN ëŒ€ì‹ ) -->
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; line-height: 1.6; color: #333; }
.container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
.header { background: #2563eb; color: white; padding: 1rem; display: flex; justify-content: space-between; align-items: center; }
.btn { background: #2563eb; color: white; padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; text-decoration: none; display: inline-block; font-weight: 500; transition: background 0.3s; }
.btn:hover { background: #1d4ed8; }
.btn-primary { background: linear-gradient(45deg, #667eea, #764ba2); }
.btn-orange { background: #ea580c; }
.card { background: white; border-radius: 12px; padding: 24px; margin: 16px 0; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
.form-group { margin-bottom: 20px; }
.form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #374151; }
.form-control { width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 16px; }
.form-control:focus { border-color: #2563eb; outline: none; box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }
select.form-control { cursor: pointer; }
textarea.form-control { min-height: 100px; resize: vertical; }
.text-center { text-align: center; }
.text-red { color: #dc2626; }
.bg-warning { background: #fef3c7; border-left: 4px solid #f59e0b; padding: 16px; border-radius: 6px; margin: 16px 0; }
.bg-error { background: #fee2e2; border-left: 4px solid #ef4444; padding: 16px; border-radius: 6px; margin: 16px 0; }
.grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
.pipeline-info { background: rgba(37,99,235,0.1); border-radius: 12px; padding: 20px; margin: 20px 0; }
.pipeline-stage { display: flex; align-items: center; gap: 16px; margin: 12px 0; padding: 12px; background: white; border-radius: 8px; }
.stage-number { background: #2563eb; color: white; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
h1, h2, h3, h4 { color: #1f2937; margin-bottom: 12px; }
h1 { font-size: 2.5rem; }
h2 { font-size: 2rem; }
h3 { font-size: 1.5rem; }
p { margin-bottom: 12px; }
.feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin: 20px 0; }
.feature-card { background: #f8fafc; border: 1px solid #e2e8f0; padding: 16px; border-radius: 8px; text-align: center; }
.info-section { background: white; border-radius: 16px; padding: 32px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); margin: 20px 0; }

/* ì¶”ê°€ ìŠ¤íƒ€ì¼ */
.prediction-form {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 16px;
    padding: 2rem;
    color: #1f2937;
    margin-bottom: 2rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
}

.form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin: 1.5rem 0;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.form-group label {
    font-weight: 600;
    font-size: 0.9rem;
    color: #374151;
}

.form-group select,
.form-group textarea {
    padding: 0.75rem;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    background: #ffffff;
    color: #1f2937;
    font-size: 14px;
}

.form-group select option {
    background: #ffffff;
    color: #1f2937;
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #2563eb;
    background: #ffffff;
    box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.predict-button {
    background: linear-gradient(45deg, #ff6b6b, #ffa726);
    border: none;
    color: white;
    font-weight: bold;
    font-size: 1.1rem;
    padding: 1rem 2rem;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
}

.predict-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
}

.predict-button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

.pipeline-info {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 12px;
    padding: 1.5rem;
    margin: 1.5rem 0;
}

.pipeline-stage {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin: 0.8rem 0;
    padding: 0.8rem;
    background: #ffffff;
    border: 1px solid #e9ecef;
    border-radius: 8px;
}

.stage-number {
    background: #2563eb;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 0.9rem;
}

.stage-info h4 {
    margin: 0 0 0.3rem 0;
    font-size: 1rem;
    color: #1f2937;
}

.stage-info p {
    margin: 0;
    font-size: 0.85rem;
    color: #6b7280;
}

.info-section {
    background: white;
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
}

.feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
}

.feature-card {
    background: #f8f9ff;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    padding: 1rem;
    text-align: center;
}

.feature-card h4 {
    margin: 0 0 0.5rem 0;
    color: #4a5568;
    font-size: 0.9rem;
}

.feature-card p {
    margin: 0;
    color: #718096;
    font-size: 0.8rem;
}

@media (max-width: 768px) {
    .form-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }

    .prediction-form {
        padding: 1.5rem;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-6xl">
    <!-- í˜ì´ì§€ í—¤ë” -->
    <div class="text-center mb-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-4">ğŸ”® AI ì¥í•´ë“±ê¸‰ ì˜ˆì¸¡</h1>
        <p class="text-xl text-gray-600">3ë‹¨ê³„ AI íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ì •í™•í•œ ì¥í•´ë“±ê¸‰ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤</p>
    </div>

    {% if not disability_service_available %}
    <!-- ì„œë¹„ìŠ¤ ì¤€ë¹„ì¤‘ ë©”ì‹œì§€ -->
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-6 mb-8 rounded-r-lg">
        <div class="flex">
            <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                </svg>
            </div>
            <div class="ml-3">
                <h3 class="text-sm font-medium text-yellow-800">ì„œë¹„ìŠ¤ ì¤€ë¹„ ì¤‘</h3>
                <p class="mt-2 text-sm text-yellow-700">
                    ì¥í•´ë“±ê¸‰ ì˜ˆì¸¡ AI ì„œë¹„ìŠ¤ë¥¼ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤. ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.
                </p>
            </div>
        </div>
    </div>
    {% endif %}

    {% if error %}
    <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
    <div class="bg-red-50 border-l-4 border-red-400 p-6 mb-8 rounded-r-lg">
        <div class="flex">
            <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                </svg>
            </div>
            <div class="ml-3">
                <h3 class="text-sm font-medium text-red-800">ì˜¤ë¥˜ ë°œìƒ</h3>
                <p class="mt-2 text-sm text-red-700">{{ error }}</p>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- ì˜ˆì¸¡ í¼ -->
    {% if disability_service_available %}
    <div class="prediction-form">
        <div class="text-center mb-6">
            <h2 class="text-2xl font-bold mb-2">ğŸ¯ ì¥í•´ë“±ê¸‰ ì˜ˆì¸¡ ì‹ ì²­</h2>
            <p class="text-lg opacity-90">ì•„ë˜ ì •ë³´ë¥¼ ì…ë ¥í•˜ì‹œë©´ AIê°€ ì¥í•´ë“±ê¸‰ì„ ì˜ˆì¸¡í•´ë“œë¦½ë‹ˆë‹¤</p>
        </div>

        <form method="POST" action="/analysis/disability" id="predictionForm">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}">

            <!-- ê¸°ë³¸ ì •ë³´ -->
            <div class="form-grid">
                <div class="form-group">
                    <label for="accident_type">ì¬í•´ ìœ í˜• <span class="text-red-300">*</span></label>
                    <select name="accident_type" id="accident_type" required>
                        <option value="1" selected>ì¶”ë½</option>
                        <option value="2">ì¶©ëŒ</option>
                        <option value="3">ë¼ì„</option>
                        <option value="4">ì ˆë‹¨/ë² ì„</option>
                        <option value="5">í™”ì¬/í­ë°œ</option>
                        <option value="6">êµí†µì‚¬ê³ </option>
                        <option value="7">ê¸°ê³„/ì¥ë¹„ ê´€ë ¨</option>
                        <option value="8">ê¸°íƒ€</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="gender">ì„±ë³„ <span class="text-red-300">*</span></label>
                    <select name="gender" id="gender" required>
                        <option value="1">ë‚¨ì„±</option>
                        <option value="2">ì—¬ì„±</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="age_group">ë‚˜ì´ëŒ€ <span class="text-red-300">*</span></label>
                    <select name="age_group" id="age_group" required>
                        <option value="1">20ëŒ€ ì´í•˜</option>
                        <option value="2">30ëŒ€</option>
                        <option value="3" selected>40ëŒ€</option>
                        <option value="4">50ëŒ€</option>
                        <option value="5">60ëŒ€</option>
                        <option value="6">70ëŒ€ ì´ìƒ</option>
                    </select>
                </div>
            </div>

            <!-- ìƒì„¸ ì •ë³´ -->
            <div class="form-grid">
                <div class="form-group">
                    <label for="industry_type">ì‚°ì—… ë¶„ë¥˜ <span class="text-red-300">*</span></label>
                    <select name="industry_type" id="industry_type" required>
                        <option value="1">ë†ì—…/ì„ì—…/ì–´ì—…</option>
                        <option value="2" selected>ì œì¡°ì—…</option>
                        <option value="3">ê±´ì„¤ì—…</option>
                        <option value="4">ìš´ìˆ˜ì—…</option>
                        <option value="5">ì„œë¹„ìŠ¤ì—…</option>
                        <option value="6">ì‚¬ì—…ì„œë¹„ìŠ¤ì—…</option>
                        <option value="7">ë³´ê±´/ì‚¬íšŒë³µì§€ì—…</option>
                        <option value="8">ê¸°íƒ€ ì‚°ì—…</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="body_part">ë¶€ìƒ ë¶€ìœ„ <span class="text-red-300">*</span></label>
                    <select name="body_part" id="body_part" required>
                        <option value="1">ë¨¸ë¦¬/ì–¼êµ´</option>
                        <option value="2">ëª©/ëª©ë¼ˆ</option>
                        <option value="3">ê°€ìŠ´/í‰ë¶€</option>
                        <option value="4">ë³µë¶€/ë°°</option>
                        <option value="5" selected>íŒ”/ì–´ê¹¨</option>
                        <option value="6">ë‹¤ë¦¬/ë¬´ë¦</option>
                        <option value="7">ì†/ì†ê°€ë½</option>
                        <option value="8">ë°œ/ë°œê°€ë½</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="injury_type">ë¶€ìƒ ì¢…ë¥˜ <span class="text-red-300">*</span></label>
                    <select name="injury_type" id="injury_type" required>
                        <option value="1">ì ˆë‹¨</option>
                        <option value="2">ê³¨ì ˆ</option>
                        <option value="3">íƒˆêµ¬</option>
                        <option value="4" selected>ì—¼ì¢Œ</option>
                        <option value="5">íƒ€ë°•ìƒ</option>
                        <option value="6">ì°°ê³¼ìƒ</option>
                    </select>
                </div>
            </div>

            <!-- ì¹˜ë£Œ ì •ë³´ -->
            <div class="form-grid">
                <div class="form-group">
                    <label for="treatment_period">ì¹˜ë£Œ ê¸°ê°„ <span class="text-red-300">*</span></label>
                    <select name="treatment_period" id="treatment_period" required>
                        <option value="1">1ê°œì›” ë¯¸ë§Œ</option>
                        <option value="2">1-2ê°œì›”</option>
                        <option value="3" selected>3ê°œì›”</option>
                        <option value="4">4-6ê°œì›”</option>
                        <option value="5">6ê°œì›”-1ë…„</option>
                        <option value="6">1ë…„ ì´ìƒ</option>
                    </select>
                </div>
            </div>

            <!-- ì¥í•´ ë‚´ìš© ìƒì„¸ ì„¤ëª… (ì˜¤ë¥˜ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼) -->
            <div class="form-group" style="margin-top: 1.5rem;">
                <label for="ì¥í•´_ë‚´ìš©" style="font-size: 1rem; font-weight: 600; color: #1f2937; margin-bottom: 0.75rem;">ì¥í•´ ë‚´ìš© ìƒì„¸ ì„¤ëª… <span class="text-red-500">*</span></label>

                <!-- ê²½ê³  ìŠ¤íƒ€ì¼ ì»¨í…Œì´ë„ˆ -->
                <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-3">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="ml-3">
                            <h4 class="text-sm font-medium text-red-800">ì‚°ì—…ì¬í•´ ê´€ë ¨ ë‚´ìš©ì„ í¬í•¨í•´ì£¼ì„¸ìš”. (ì˜ˆ: ì‘ì—…, ì‚¬ê³ , ë¶€ìƒ, ê¸°ê³„ ë“±)</h4>
                            <div class="mt-2 text-sm text-red-700">
                                <p>ì˜¬ë°”ë¥¸ ì˜ˆì‹œ:</p>
                                <ul class="list-disc list-inside space-y-1">
                                    <li>ì‘ì—… ì¤‘ í”„ë ˆìŠ¤ ê¸°ê³„ì— ì†ê°€ë½ ì ˆë‹¨, ê³„ë‹¨ì—ì„œ ì¶”ë½í•˜ì—¬ ë‹¤ë¦¬ ê³¨ì ˆ ë“± êµ¬ì²´ì ì¸ ì‚¬ê³  ê²½ìœ„</li>
                                    <li>ê±´ì„¤í˜„ì¥ ë¹„ê³„ ì¶”ë½ìœ¼ë¡œ ì¸í•œ íŒ”ê¿ˆì¹˜ ë¶€ìƒ</li>
                                    <li>ìš©ì ‘ ì‘ì—… ì¤‘ í™”ìƒìœ¼ë¡œ ì¸í•œ í™”ìƒ</li>
                                    <li>í¬ë ˆì¸ ì‘ì—… ì¤‘ ì¶©ëŒ ì‚¬ê³ </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <textarea
                    name="ì¥í•´_ë‚´ìš©"
                    id="ì¥í•´_ë‚´ìš©"
                    placeholder="ì˜ˆ: í”„ë ˆìŠ¤ ì‘ì—… ì¤‘ ì†ê°€ë½ ì ˆë‹¨, ê³„ë‹¨ì—ì„œ ì¶”ë½í•˜ì—¬ ë‹¤ë¦¬ ê³¨ì ˆ ë“± êµ¬ì²´ì ì¸ ì‚¬ê³  ê²½ìœ„ì™€ ë¶€ìƒ ë‚´ìš©ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”."
                    required
                    style="width: 100%; min-height: 120px; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 8px; resize: vertical;"
                ></textarea>
            </div>

            <!-- ì œì¶œ ë²„íŠ¼ -->
            <div class="text-center" style="margin-top: 2rem;">
                <button type="submit" class="predict-button" id="submitBtn">
                    ğŸ”® ì¥í•´ë“±ê¸‰ ì˜ˆì¸¡í•˜ê¸°
                </button>
            </div>
        </form>

    </div>
    {% endif %}

    <!-- ì„œë¹„ìŠ¤ ì •ë³´ -->
    <div class="info-section">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">â„¹ï¸ ì˜ˆì¸¡ ì„œë¹„ìŠ¤ ì •ë³´</h2>

        <div class="feature-grid">
            <div class="feature-card" style="background: linear-gradient(135deg, #fef2f2, #fee2e2); border-left: 4px solid #ef4444;">
                <h4 style="color: #dc2626;">ì…ë ¥ ë°ì´í„°</h4>
                <p style="color: #991b1b;">7ê°œ ì„ íƒê°’ + 1ê°œ í…ìŠ¤íŠ¸</p>
            </div>
            <div class="feature-card" style="background: linear-gradient(135deg, #fef2f2, #fecaca); border-left: 4px solid #f87171;">
                <h4 style="color: #b91c1c;">ì˜ˆì¸¡ ë²”ìœ„</h4>
                <p style="color: #7f1d1d;">1ê¸‰(ê°€ì¥ ì‹¬ê°) ~ 15ê¸‰(ê²½ë¯¸)</p>
            </div>
            <div class="feature-card" style="background: linear-gradient(135deg, #fff5f5, #fed7d7); border-left: 4px solid #fc8181;">
                <h4 style="color: #c53030;">ì²˜ë¦¬ ì‹œê°„</h4>
                <p style="color: #9c1c1c;">í‰ê·  2-5ì´ˆ ë‚´ ê²°ê³¼</p>
            </div>
            <div class="feature-card" style="background: linear-gradient(135deg, #fef5e7, #fed7aa); border-left: 4px solid #fb923c;">
                <h4 style="color: #ea580c;">í™œìš© ë°ì´í„°</h4>
                <p style="color: #c2410c;">ì‚°ì¬ íŒë¡€ 1,000+ ê±´</p>
            </div>
        </div>

        <div class="bg-red-50 border-l-4 border-red-400 p-6 mt-6 rounded-r-lg">
            <div class="flex">
                <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                    </svg>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-red-800">ì°¸ê³ ì‚¬í•­</h3>
                    <p class="mt-2 text-sm text-red-700">
                        ì´ ì˜ˆì¸¡ì€ ì°¸ê³ ìš©ì´ë©°, ì •í™•í•œ ì¥í•´ë“±ê¸‰ì€ ì˜ë£Œì§„ì˜ ì§„ë‹¨ê³¼ ì‹¬ì‚¬ë¥¼ í†µí•´ ê²°ì •ë©ë‹ˆë‹¤.
                        ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì „ë¬¸ê°€ ìƒë‹´ì„ ë°›ì•„ë³´ì‹œê¸°ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- AI íŒŒì´í”„ë¼ì¸ ì •ë³´ -->
    <div class="info-section">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">ğŸ¤– AI ì˜ˆì¸¡ íŒŒì´í”„ë¼ì¸</h2>

        <div class="pipeline-info">
            <div class="pipeline-stage" style="background: linear-gradient(135deg, #fef2f2, #fee2e2); border-left: 4px solid #ef4444;">
                <div class="stage-number">ğŸ¯</div>
                <div class="stage-info">
                    <h4 style="color: #dc2626;">ì •í™• ë¬¸êµ¬ ë§¤ì¹­</h4>
                    <p style="color: #991b1b;">ì…ë ¥ëœ ì¥í•´ ë‚´ìš©ì—ì„œ ì •í™•í•œ í‚¤ì›Œë“œë¥¼ ì°¾ì•„ ì¦‰ì‹œ ë§¤ì¹­ (ì •í™•ë„ 100%)</p>
                </div>
            </div>

            <div class="pipeline-stage" style="background: linear-gradient(135deg, #fef2f2, #fecaca); border-left: 4px solid #f87171;">
                <div class="stage-number">ğŸ§ </div>
                <div class="stage-info">
                    <h4 style="color: #b91c1c;">BERT ìœ ì‚¬ë„ ë§¤ì¹­</h4>
                    <p style="color: #7f1d1d;">AI ì–¸ì–´ ëª¨ë¸ì„ ì‚¬ìš©í•´ ìœ ì‚¬í•œ ì‚¬ë¡€ì™€ ë¹„êµ ë¶„ì„ (ì„ê³„ê°’ 72%)</p>
                </div>
            </div>

            <div class="pipeline-stage" style="background: linear-gradient(135deg, #fff5f5, #fed7d7); border-left: 4px solid #fc8181;">
                <div class="stage-number">âš™ï¸</div>
                <div class="stage-info">
                    <h4 style="color: #c53030;">2-Stage ë¨¸ì‹ ëŸ¬ë‹ ì˜ˆì¸¡</h4>
                    <p style="color: #9c1c1c;">K-Prototypes í´ëŸ¬ìŠ¤í„°ë§ê³¼ ë”¥ëŸ¬ë‹ ëª¨ë¸ì„ í†µí•œ ì¢…í•©ì  ì˜ˆì¸¡</p>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_scripts %}
<script>

// ê°•í™”ëœ ì…ë ¥ ê²€ì¦ í•¨ìˆ˜
function validateInjuryContent(content) {
    const errors = [];

    // ìµœì†Œ ê¸¸ì´ ì²´í¬
    if (content.length < 10) {
        errors.push('ì¥í•´ ë‚´ìš©ì„ ë” ìì„¸íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”. (ìµœì†Œ 10ì ì´ìƒ)');
        return errors;
    }

    // íŠ¹ìˆ˜ë¬¸ìë‚˜ ìˆ«ìë§Œ ì…ë ¥ ë°©ì§€
    const onlySpecialCharsOrNumbers = /^[^ê°€-í£a-zA-Z]*$/.test(content);
    if (onlySpecialCharsOrNumbers) {
        errors.push('í•œê¸€ ë˜ëŠ” ì˜ë¬¸ìœ¼ë¡œ êµ¬ì²´ì ì¸ ì‚¬ê³  ìƒí™©ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”.');
        return errors;
    }

    // ë°˜ë³µ ë¬¸ì ë°©ì§€ (ê°™ì€ ë¬¸ì 4ë²ˆ ì´ìƒ)
    const repeatedChars = /(.)\1{3,}/.test(content);
    if (repeatedChars) {
        errors.push('ì˜ë¯¸ìˆëŠ” ë‚´ìš©ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”. ê°™ì€ ë¬¸ìë¥¼ ë°˜ë³µí•˜ì§€ ë§ˆì„¸ìš”.');
        return errors;
    }

    // í‚¤ë³´ë“œ ìˆœì„œ ì…ë ¥ ë°©ì§€
    const nonsensePatterns = [
        /asdf|qwer|zxcv|1234|abcd|ã…ã„´ã…‡ã„¹|ã…‚ã…ˆã„·ã„±|asdasd|qweqwe/gi,
        /^\w{1,2}$/, // ë„ˆë¬´ ì§§ì€ ì˜ë¬¸
        /^[ã„±-ã…ã…-ã…£]+$/ // ììŒì´ë‚˜ ëª¨ìŒë§Œ
    ];

    for (const pattern of nonsensePatterns) {
        if (pattern.test(content)) {
            errors.push('êµ¬ì²´ì ì´ê³  ì˜ë¯¸ìˆëŠ” ì‚¬ê³  ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.');
            return errors;
        }
    }

    // ì‚°ì—…ì¬í•´ ê´€ë ¨ í‚¤ì›Œë“œ í™•ì¸
    const injuryKeywords = [
        'ì‘ì—…', 'ì¼', 'ì—…ë¬´', 'ì‚¬ê³ ', 'ë¶€ìƒ', 'ë‹¤ì¹˜ë‹¤', 'ì•„í”„ë‹¤', 'ê³¨ì ˆ', 'ì ˆë‹¨', 'í™”ìƒ', 'ë„˜ì–´ì§€ë‹¤',
        'ë–¨ì–´ì§€ë‹¤', 'ë¯¸ë„ëŸ¬ì§€ë‹¤', 'ë¼ì´ë‹¤', 'ë§ë‹¤', 'ì¶©ëŒ', 'ì¶”ë½', 'ë¨¸ë¦¬', 'ëª©', 'íŒ”', 'ë‹¤ë¦¬', 'ì†', 'ë°œ',
        'í—ˆë¦¬', 'ê°€ìŠ´', 'ì–´ê¹¨', 'ë¬´ë¦', 'ì†ê°€ë½', 'ë°œê°€ë½', 'í”„ë ˆìŠ¤', 'ê¸°ê³„', 'ì¥ë¹„', 'ì‚¬ë‹¤ë¦¬', 'ê³„ë‹¨',
        'ê³µì¥', 'ê±´ì„¤', 'í˜„ì¥', 'ì‚¬ë¬´ì‹¤', 'ì°½ê³ ', 'ë³‘ì›', 'ì¹˜ë£Œ', 'ìˆ˜ìˆ ', 'ì•„í””', 'í†µì¦', 'ë§ˆë¹„'
    ];

    const hasValidKeyword = injuryKeywords.some(keyword =>
        content.toLowerCase().includes(keyword) || content.includes(keyword)
    );

    if (!hasValidKeyword) {
        errors.push('ì‚°ì—…ì¬í•´ì™€ ê´€ë ¨ëœ êµ¬ì²´ì ì¸ ë¶€ìƒì´ë‚˜ ì‚¬ê³  ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return errors;
    }

    return errors;
}

// í¼ ì œì¶œ ì²˜ë¦¬
document.getElementById('predictionForm').addEventListener('submit', function(e) {
    const submitBtn = document.getElementById('submitBtn');
    const injury_description = document.getElementById('ì¥í•´_ë‚´ìš©').value.trim();

    if (!injury_description) {
        e.preventDefault();
        alert('ì¥í•´ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
    }

    // ê°•í™”ëœ ê²€ì¦ ì‹¤í–‰
    const validationErrors = validateInjuryContent(injury_description);
    if (validationErrors.length > 0) {
        e.preventDefault();
        alert(validationErrors[0]); // ì²« ë²ˆì§¸ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
        return;
    }

    // ì œì¶œ ë²„íŠ¼ ë¹„í™œì„±í™”
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'ğŸ”„ ì˜ˆì¸¡ ì¤‘...';
    submitBtn.style.opacity = '0.6';
});

// ì‹¤ì‹œê°„ ì…ë ¥ ê²€ì¦ ê¸°ëŠ¥
function setupRealTimeValidation() {
    const textarea = document.getElementById('ì¥í•´_ë‚´ìš©');
    const submitBtn = document.getElementById('submitBtn');

    if (!textarea || !submitBtn) return;

    // ì´ˆê¸° ë²„íŠ¼ ìƒíƒœ
    submitBtn.disabled = true;
    submitBtn.style.opacity = '0.6';
    submitBtn.innerHTML = 'ì¥í•´ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”';

    // ì‹¤ì‹œê°„ ê²€ì¦
    textarea.addEventListener('input', function() {
        const content = this.value.trim();

        if (!content) {
            submitBtn.disabled = true;
            submitBtn.style.opacity = '0.6';
            submitBtn.innerHTML = 'ì¥í•´ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”';
            this.style.borderColor = '#d1d5db';
            return;
        }

        const errors = validateInjuryContent(content);

        if (errors.length > 0) {
            submitBtn.disabled = true;
            submitBtn.style.opacity = '0.6';
            submitBtn.innerHTML = 'ì…ë ¥ì„ í™•ì¸í•´ì£¼ì„¸ìš”';
            this.style.borderColor = '#ef4444';
            this.title = errors[0]; // íˆ´íŒìœ¼ë¡œ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
        } else {
            submitBtn.disabled = false;
            submitBtn.style.opacity = '1';
            submitBtn.innerHTML = 'ğŸ”® ì¥í•´ë“±ê¸‰ ì˜ˆì¸¡í•˜ê¸°';
            this.style.borderColor = '#22c55e';
            this.title = 'ì…ë ¥ ì™„ë£Œ! ì˜ˆì¸¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.';
        }
    });
}

// DOMContentLoaded ì´ë²¤íŠ¸ì—ì„œ ì‹¤ì‹œê°„ ê²€ì¦ ì„¤ì •
document.addEventListener('DOMContentLoaded', function() {
    setupRealTimeValidation();
});

// í¼ í•„ë“œ ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
const formFields = ['gender', 'age_group', 'industry_type', 'accident_type', 'body_part', 'injury_type', 'treatment_period'];
formFields.forEach(fieldId => {
    document.getElementById(fieldId).addEventListener('change', function() {
        console.log(`${fieldId} changed to:`, this.value);
    });
});
</script>
{% endblock %}