# SANZERO 테스트 계획

## 📋 테스트 전략

- **테스트 레벨별로 각각 테스트**
  1. **단위 테스트**: 개별 함수 및 메서드 검증
  2. **통합 테스트**: API 엔드포인트 검증
  3. **E2E 테스트**: 전체 사용자 시나리오 검증

## 🛠️ 테스트 환경

- **로컬**: Python pytest + FastAPI TestClient
- **E2E**: Puppeteer MCP 브라우저 자동화
- **데이터베이스**: 실제 Supabase 환경 (.env)
- **배포**: Docker Compose 환경

## 🎯 기능별 테스트 케이스

### 1. 인증 시스템 테스트 🔐

#### 회원가입 및 로그인
- [ ] **회원가입 정상 플로우**: 이메일, 비밀번호 검증
- [ ] **로그인/로그아웃**: 세션 관리, 토큰 처리
- [ ] **권한 기반 접근 제어**: 일반/노무사/관리자 권한 구분
- [ ] **JWT 토큰 검증**: 유효성, 만료 처리
- [ ] **비밀번호 보안**: 해시 처리, 복잡성 요구사항

#### 보안 검증
- [ ] **CSRF 방어**: Double Submit Cookie 패턴 동작
- [ ] **XSS 방어**: 사용자 입력 sanitization 확인
- [ ] **세션 보안**: HttpOnly, Secure 쿠키 설정

### 2. 산재 보상 신청 테스트 💼

#### 보상금 계산기
- [ ] **정확한 계산**: 2025년 기준 보상금 수식 검증
- [ ] **다양한 시나리오**: 5가지 보상금 유형별 계산
- [ ] **예외 케이스**: 잘못된 입력값 처리
- [ ] **경계값 테스트**: 최소/최대 급여, 치료 기간

#### 신청서 관리 (CRUD)
- [ ] **신청서 작성**: 필수 필드 검증, 데이터 저장
- [ ] **신청서 조회**: 권한별 접근, 목록/상세 보기
- [ ] **신청서 수정**: 상태별 편집 권한, 이력 관리
- [ ] **신청서 삭제**: 논리 삭제, 복구 가능성

#### 관리자 승인 프로세스
- [ ] **승인/거부 처리**: 상태 변경, 알림 발송
- [ ] **통계 대시보드**: 승인율, 처리 시간 계산
- [ ] **변경 이력 추적**: 모든 수정 사항 로깅

### 3. 노무사 서비스 테스트 👨‍💼

#### 검색 및 매칭
- [ ] **노무사 검색**: 이름, 지역, 전문분야 필터링
- [ ] **AI 기반 매칭**: 사용자 요구사항과 노무사 매칭
- [ ] **평점 시스템**: 별점, 리뷰 관리
- [ ] **프로필 관리**: 노무사 정보 업데이트

#### 상담 예약 시스템
- [ ] **예약 생성**: 날짜/시간 선택, 중복 방지
- [ ] **예약 관리**: 취소, 변경, 알림
- [ ] **상담료 계산**: 자동 계산, 결제 연동 준비
- [ ] **가용성 확인**: 실시간 일정 체크

### 4. AI 분석 서비스 테스트 🤖

#### 판례 분석
- [ ] **RAG 기반 검색**: SBERT 임베딩, pgvector 유사도
- [ ] **LLM API 연동**: OpenAI/Anthropic 응답 처리
- [ ] **사안 유불리 분석**: 분석 결과 정확성
- [ ] **법적 권고사항**: 의미있는 조언 생성

#### 데이터 관리
- [ ] **자동 크롤링**: 대법원 판례 수집 검증
- [ ] **품질 관리**: 데이터 품질 점수 시스템
- [ ] **벡터 임베딩**: 새로운 판례 자동 처리

#### 장해등급 예측 (준비 중)
- [ ] **UI 접근성**: "준비 중" 메시지 표시 확인
- [ ] **API 응답**: 501 상태 코드 정상 반환
- [ ] **향후 확장성**: 모델 통합 인터페이스 준비

### 5. 관리자 시스템 테스트 ⚙️

#### 사용자 관리
- [ ] **계정 관리**: 사용자 생성, 수정, 비활성화
- [ ] **권한 변경**: 일반↔노무사 권한 전환
- [ ] **활동 로그**: 사용자 행동 추적

#### 신청 관리
- [ ] **승인/거부 처리**: 일괄 처리, 개별 처리
- [ ] **검토 시스템**: 신청서 품질 평가
- [ ] **알림 발송**: 결정사항 자동 알림

#### 데이터 대시보드
- [ ] **통계 표시**: 실시간 지표 업데이트
- [ ] **시스템 모니터링**: 성능, 오류율 추적
- [ ] **보고서 생성**: 주기별 리포트 생성

### 6. 보안 테스트 🔒

#### 웹 애플리케이션 보안
- [ ] **CSRF 방어**: 토큰 검증, 중복 제출 방지
- [ ] **XSS 방어**: 모든 입력 필드 sanitization
- [ ] **SQL 인젝션 방어**: 매개변수화된 쿼리 사용
- [ ] **파일 업로드 보안**: 허용된 파일 타입만 처리

#### 접근 제어
- [ ] **권한 기반 접근**: URL 레벨 권한 검증
- [ ] **데이터 격리**: 사용자별 데이터 분리
- [ ] **민감정보 보호**: 의료정보, 급여정보 암호화

#### 로깅 및 감사
- [ ] **접근 로그**: 모든 중요 작업 기록
- [ ] **에러 로깅**: 민감정보 제외한 오류 추적
- [ ] **보안 이벤트**: 비정상 접근 패턴 감지

## 📊 성능 테스트

### 응답 시간 목표
- [ ] **API 응답**: 평균 < 200ms (AI 분석 제외)
- [ ] **페이지 로딩**: 첫 로딩 < 2초
- [ ] **AI 분석**: < 30초 (타임아웃 처리)

### 부하 테스트
- [ ] **동시 사용자**: 100명 동시 접속 처리
- [ ] **데이터베이스**: 1,000+ 판례 검색 성능
- [ ] **파일 업로드**: 10MB 파일 처리 안정성

### Docker 환경 안정성
- [ ] **컨테이너 Health Check**: 자동 복구 동작
- [ ] **리소스 사용량**: CPU, 메모리 모니터링
- [ ] **로그 관리**: 로그 순환, 보관 정책

## 📚 테스트 데이터

### 테스트 계정
- **관리자**: byoneself4023@ajou.ac.kr (Kuka)
- **일반 사용자**: testuser@example.com, testworker@example.com
- **노무사**: lawyer@example.com

_자세한 테스트 계정 정보와 비밀번호는 @TESTDATA.md 참조_

### 테스트 시나리오 데이터
- **보상금 신청서**: 다양한 사고 유형별 샘플 데이터
- **판례 데이터**: AI 분석용 테스트 케이스
- **노무사 프로필**: 매칭 알고리즘 테스트용 데이터

## 🚀 테스트 실행 방법

### 로컬 개발 환경
```bash
# 1. 환경 준비
docker compose up -d
python -m pytest app/tests/

# 2. 단위 테스트 실행
pytest app/tests/unit/

# 3. 통합 테스트 실행
pytest app/tests/integration/
```

### E2E 테스트 (Puppeteer MCP)
```bash
# 1. Docker 환경 실행
docker compose up --build -d

# 2. Puppeteer MCP를 통한 브라우저 테스트
# - 로그인/로그아웃 플로우
# - 보상금 신청 전체 과정
# - 노무사 검색 및 예약
# - AI 분석 서비스 사용
# - 관리자 승인 프로세스
```

### 자동화 테스트
```bash
# 전체 테스트 스위트 (예정)
./scripts/run_all_tests.sh

# 성능 테스트 (예정)
./scripts/performance_test.sh

# 보안 테스트 (예정)
./scripts/security_test.sh
```

## ✅ 테스트 완료 기준

### 기본 요구사항 (100% 통과 필요)
- [ ] 모든 핵심 기능 정상 동작
- [ ] 보안 테스트 통과 (CSRF, XSS, 권한 제어)
- [ ] 성능 목표 달성 (응답 시간, 동시 사용자)

### 품질 요구사항 (95% 이상 통과)
- [ ] 예외 상황 처리 (네트워크 오류, 잘못된 입력)
- [ ] 사용자 경험 (에러 메시지, 로딩 인디케이터)
- [ ] 접근성 (키보드 네비게이션, 화면 리더 호환)

### 운영 준비사항
- [ ] Docker 환경 안정성 검증
- [ ] 로그 및 모니터링 시스템 동작
- [ ] 데이터 백업 및 복구 절차 확인

---

## 📞 문의 및 지원

- **테스트 관련 문의**: 개발팀 내부 문서 참조
- **버그 리포트**: GitHub Issues 또는 내부 이슈 트래커
- **테스트 가이드**: @NOTE.md 개발 참고사항 확인

---

*문서 최종 업데이트: 2025-11-13*
*테스트 환경: SANZERO v1.0 Production Ready*